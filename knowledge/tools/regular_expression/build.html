<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.26" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.183" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"构建","image":[""],"dateModified":"2026-02-04T07:26:46.000Z","author":[]}</script><meta property="og:url" content="https://docs.elake.top/knowledge/tools/regular_expression/build.html"><meta property="og:site_name" content="洱海文档"><meta property="og:title" content="构建"><meta property="og:description" content="对于一门语言的掌握程度怎么样, 可以有两个角度来衡量: 读和写. 不仅要看懂别人的解决方案, 也要能独立地解决问题. 代码是这样, 正则表达式也是这样. 与读相比, 写往往更为重要, 这个道理是不言而喻的. 对正则的运用, 首重就是:如何针对问题, 构建一个合适的正则表达式? 平衡法则 构建正则有一点非常重要, 需要做到下面几点的平衡: 匹配预期的字符..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2026-02-04T07:26:46.000Z"><meta property="article:modified_time" content="2026-02-04T07:26:46.000Z"><link rel="icon" type="image/png" href="/images/logo.svg"><title>构建 | 洱海文档</title><meta name="description" content="对于一门语言的掌握程度怎么样, 可以有两个角度来衡量: 读和写. 不仅要看懂别人的解决方案, 也要能独立地解决问题. 代码是这样, 正则表达式也是这样. 与读相比, 写往往更为重要, 这个道理是不言而喻的. 对正则的运用, 首重就是:如何针对问题, 构建一个合适的正则表达式? 平衡法则 构建正则有一点非常重要, 需要做到下面几点的平衡: 匹配预期的字符..."><link rel="preload" href="/assets/style-DjpXMju2.css" as="style"><link rel="stylesheet" href="/assets/style-DjpXMju2.css"><link rel="modulepreload" href="/assets/app-znotv2QM.js"><link rel="modulepreload" href="/assets/build.html-BJOt0VVF.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-e0480511><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-7cd68948></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-7cd68948> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-e0480511 data-v-e6c0f005><div class="vp-navbar" vp-navbar data-v-e6c0f005 data-v-0408d719><div class="wrapper" data-v-0408d719><div class="container" data-v-0408d719><div class="title" data-v-0408d719><div class="vp-navbar-title has-sidebar" data-v-0408d719 data-v-fb420566><a class="vp-link link no-icon title" href="/" data-v-fb420566><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="/images/logo.svg" alt data-v-c9aa8cda><!--]--><!--[--><img class="vp-image light logo" style="" src="/images/logo.svg" alt data-v-c9aa8cda><!--]--><!--]--><!--]--><span data-v-fb420566>洱海文档</span><!--[--><!--]--><!--]--></a></div></div><div class="content" data-v-0408d719><div class="content-body" data-v-0408d719><!--[--><!--]--><div class="vp-navbar-search search" data-v-0408d719><div class="search-wrapper" data-v-262429f4><!----><div id="local-search" data-v-262429f4><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-262429f4><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-0408d719 data-v-81e8d227><span id="main-nav-aria-label" class="visually-hidden" data-v-81e8d227>Main Navigation</span><!--[--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-81e8d227 data-v-bbbfcb2d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bbbfcb2d><span class="text" data-v-bbbfcb2d><!----><!----><span data-v-bbbfcb2d>洱海工作室</span><!----><span class="vpi-chevron-down text-icon" data-v-bbbfcb2d></span></span></button><div class="menu" data-v-bbbfcb2d><div class="vp-menu" data-v-bbbfcb2d data-v-09ca9363><div class="items" data-v-09ca9363><!--[--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://www.elake.top" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 洱海博客 <!----><!--]--></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://alist.elake.top" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 洱海云盘 <!----><!--]--></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://ping.elake.top" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 服务监控 <!----><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-81e8d227 data-v-bbbfcb2d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bbbfcb2d><span class="text" data-v-bbbfcb2d><!----><!----><span data-v-bbbfcb2d>GitHub</span><!----><span class="vpi-chevron-down text-icon" data-v-bbbfcb2d></span></span></button><div class="menu" data-v-bbbfcb2d><div class="vp-menu" data-v-bbbfcb2d data-v-09ca9363><div class="items" data-v-09ca9363><!--[--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://github.com/Erhai-lake" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 洱海 <!----><!--]--></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://github.com/Qi-Month" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 柒月 <!----><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-81e8d227 data-v-bbbfcb2d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bbbfcb2d><span class="text" data-v-bbbfcb2d><!----><!----><span data-v-bbbfcb2d>Gitee</span><!----><span class="vpi-chevron-down text-icon" data-v-bbbfcb2d></span></span></button><div class="menu" data-v-bbbfcb2d><div class="vp-menu" data-v-bbbfcb2d data-v-09ca9363><div class="items" data-v-09ca9363><!--[--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://gitee.com/Erhai-lake" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 洱海 <!----><!--]--></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="https://gitee.com/Qi-Month" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 柒月 <!----><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-81e8d227 data-v-bbbfcb2d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bbbfcb2d><span class="text" data-v-bbbfcb2d><!----><!----><span data-v-bbbfcb2d>邮箱</span><!----><span class="vpi-chevron-down text-icon" data-v-bbbfcb2d></span></span></button><div class="menu" data-v-bbbfcb2d><div class="vp-menu" data-v-bbbfcb2d data-v-09ca9363><div class="items" data-v-09ca9363><!--[--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="mailto:erhai.lake.0714@gmail.com" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 洱海 <!----><!--]--></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-09ca9363 data-v-990be10e><a class="vp-link link vp-external-link-icon" href="mailto:dy757410@163.com" target="_blank" rel="noreferrer" data-v-990be10e><!--[--><!----> 柒月 <!----><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-0408d719 data-v-58acc55f><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-58acc55f data-v-08ac71ff data-v-e9ce231b><span class="check" data-v-e9ce231b><span class="icon" data-v-e9ce231b><!--[--><span class="vpi-sun sun" data-v-08ac71ff></span><span class="vpi-moon moon" data-v-08ac71ff></span><!--]--></span></span></button></div><!----><div class="vp-flyout vp-navbar-extra extra" data-v-0408d719 data-v-7198fd6a data-v-bbbfcb2d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bbbfcb2d><span class="vpi-more-horizontal icon" data-v-bbbfcb2d></span></button><div class="menu" data-v-bbbfcb2d><div class="vp-menu" data-v-bbbfcb2d data-v-09ca9363><!----><!--[--><!--[--><!----><div class="group" data-v-7198fd6a><div class="item appearance" data-v-7198fd6a><p class="label" data-v-7198fd6a>外观</p><div class="appearance-action" data-v-7198fd6a><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-7198fd6a data-v-08ac71ff data-v-e9ce231b><span class="check" data-v-e9ce231b><span class="icon" data-v-e9ce231b><!--[--><span class="vpi-sun sun" data-v-08ac71ff></span><span class="vpi-moon moon" data-v-08ac71ff></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-0408d719 data-v-2d8f4450><span class="container" data-v-2d8f4450><span class="top" data-v-2d8f4450></span><span class="middle" data-v-2d8f4450></span><span class="bottom" data-v-2d8f4450></span></span></button></div></div></div></div><div class="divider" data-v-0408d719><div class="divider-line" data-v-0408d719></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-e0480511 data-v-adf312c1><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-adf312c1><span class="vpi-align-left menu-icon" data-v-adf312c1></span><span class="menu-text" data-v-adf312c1>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-adf312c1 data-v-79303256><!----><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-e0480511 data-v-c809c65b><div class="curtain" data-v-c809c65b></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c809c65b><span id="sidebar-aria-label" class="visually-hidden" data-v-c809c65b> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-fe26ff83><section class="vp-sidebar-item sidebar-item level-0 has-active" data-v-fe26ff83 data-v-49b3caa3><!----><div data-v-49b3caa3 data-v-49b3caa3><div class="items" data-v-49b3caa3><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>正则表达式</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/fuzzy_matching.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>模糊匹配</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/position_matching.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>位置匹配</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/the_role_of_brackets.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>括号的作用</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/principle_of_backtracking.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>回溯法原理</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/split.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>拆分</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/build.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>构建</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/modifier.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>修饰符</span><!----></p><!--]--></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-49b3caa3 data-v-49b3caa3><div class="item" data-v-49b3caa3><div class="indicator" data-v-49b3caa3></div><!----><a class="vp-link link link" href="/knowledge/tools/regular_expression/end.html" data-v-49b3caa3><!--[--><p class="text" data-v-49b3caa3><span data-v-49b3caa3>尾声</span><!----></p><!--]--></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-e0480511 data-v-5c2828a8><div class="vp-doc-container has-sidebar has-aside" data-v-5c2828a8 data-v-3d04b82b><!--[--><!--]--><div class="container" data-v-3d04b82b><div class="aside" vp-outline data-v-3d04b82b><div class="aside-curtain" data-v-3d04b82b></div><div class="aside-container" data-v-3d04b82b><div class="aside-content" data-v-3d04b82b><div class="vp-doc-aside" data-v-3d04b82b data-v-91dab2d6><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-91dab2d6 data-v-4c4b186f><div class="content" data-v-4c4b186f><div class="outline-marker" data-v-4c4b186f></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-4c4b186f><span data-v-4c4b186f>此页内容</span><span class="vpi-print icon" data-v-4c4b186f></span></div><ul class="root" data-v-4c4b186f data-v-a1b34921><!--[--><!--]--></ul></div></nav><!--[--><!--[--><!--[--><!--[--><div class="aside-nav-wrapper" data-v-e0480511 data-v-baf113c5><a class="vp-link link no-icon vp-external-link-icon link" href="https://github.com/Erhai-lake/ElakeDocs" target="_blank" rel="noreferrer" data-v-baf113c5><!--[--><!----><span class="link-text" data-v-baf113c5>在 GitHub 上 Star</span><span class="vpi-arrow-right" data-v-baf113c5></span><!--]--></a><a class="vp-link link no-icon vp-external-link-icon link" href="https://github.com/Erhai-lake/ElakeDocs/issues/new/choose" target="_blank" rel="noreferrer" data-v-baf113c5><!--[--><!----><span class="link-text" data-v-baf113c5>遇到问题?</span><span class="vpi-arrow-right" data-v-baf113c5></span><!--]--></a><a class="vp-link link no-icon link" href="/sponsor/" data-v-baf113c5><!--[--><!----><span class="link-text" data-v-baf113c5>喝杯奶茶</span><span class="vpi-arrow-right" data-v-baf113c5></span><!--]--></a></div><!--]--><!--]--><!--]--><!--]--><div class="spacer" data-v-91dab2d6></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-3d04b82b><div class="content-container" data-v-3d04b82b><!--[--><!--]--><main class="main" data-v-3d04b82b><nav class="vp-breadcrumb" data-v-3d04b82b data-v-531cbaef><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-531cbaef><!--[--><li property="itemListElement" typeof="ListItem" data-v-531cbaef><a class="vp-link link no-icon breadcrumb" href="/" property="item" typeof="WebPage" data-v-531cbaef><!--[-->首页<!--]--></a><span class="vpi-chevron-right" data-v-531cbaef></span><meta property="name" content="首页" data-v-531cbaef><meta property="position" content="1" data-v-531cbaef></li><li property="itemListElement" typeof="ListItem" data-v-531cbaef><a class="vp-link link no-icon breadcrumb" href="/knowledge/" property="item" typeof="WebPage" data-v-531cbaef><!--[-->知识库<!--]--></a><span class="vpi-chevron-right" data-v-531cbaef></span><meta property="name" content="知识库" data-v-531cbaef><meta property="position" content="2" data-v-531cbaef></li><li property="itemListElement" typeof="ListItem" data-v-531cbaef><a class="vp-link link no-icon breadcrumb current" href="/knowledge/tools/regular_expression/build.html" property="item" typeof="WebPage" data-v-531cbaef><!--[-->构建<!--]--></a><!----><meta property="name" content="构建" data-v-531cbaef><meta property="position" content="3" data-v-531cbaef></li><!--]--></ol></nav><!--[--><!--]--><!--[--><div class="vp-doc-title" data-v-97d564a2><!--[--><!--]--><h1 class="page-title" data-v-97d564a2><!----> 构建 <!----></h1><!--[--><!--]--></div><div class="vp-doc-meta" data-v-97d564a2><!--[--><!--]--><p class="reading-time" data-v-97d564a2><span class="vpi-books icon" data-v-97d564a2></span><span data-v-97d564a2>约 1828 字</span><span data-v-97d564a2>大约 6 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-97d564a2><span class="vpi-clock icon" data-v-97d564a2></span><span data-v-97d564a2>2025-12-27</span></p></div><!--]--><!--[--><!--]--><!--[--><div class="_knowledge_tools_regular_expression_build external-link-icon-enabled vp-doc plume-content" vp-content data-v-3d04b82b><!--[--><!--]--><div data-v-3d04b82b><p>对于一门语言的掌握程度怎么样, 可以有两个角度来衡量: 读和写.</p><p>不仅要看懂别人的解决方案, 也要能独立地解决问题. 代码是这样, 正则表达式也是这样.</p><p>与读相比, 写往往更为重要, 这个道理是不言而喻的.</p><p>对正则的运用, 首重就是:如何针对问题, 构建一个合适的正则表达式?</p><h2 id="平衡法则" tabindex="-1"><a class="header-anchor" href="#平衡法则"><span>平衡法则</span></a></h2><p>构建正则有一点非常重要, 需要做到下面几点的平衡:</p><ol><li>匹配预期的字符串.</li><li>不匹配非预期的字符串.</li><li>可读性和可维护性.</li><li>效率.</li></ol><h2 id="构建正则前提" tabindex="-1"><a class="header-anchor" href="#构建正则前提"><span>构建正则前提</span></a></h2><h3 id="是否能使用正则" tabindex="-1"><a class="header-anchor" href="#是否能使用正则"><span>是否能使用正则</span></a></h3><p>正则太强大了, 以至于我们随便遇到一个操作字符串问题时, 都会下意识地去想, 用正则该怎么做.但我们始终要提醒自己, 正则虽然强大, 但不是万能的, 很多看似很简单的事情, 还是做不到的.</p><p>比如匹配这样的字符串: 1010010001....</p><p>虽然很有规律. 但是只靠正则就是无能为力.</p><h3 id="是否有必要使用正则" tabindex="-1"><a class="header-anchor" href="#是否有必要使用正则"><span>是否有必要使用正则</span></a></h3><p>要认识到正则的局限, 不要去研究根本无法完成的任务. 同时, 也不能走入另一个极端: 无所不用正则. 能用字符串API解决的简单问题, 就不该正则出马.</p><h3 id="是否有必要构建一个复杂的正则" tabindex="-1"><a class="header-anchor" href="#是否有必要构建一个复杂的正则"><span>是否有必要构建一个复杂的正则</span></a></h3><p>比如密码匹配问题, 要求密码长度6-12位, 由数字, 小写字符和大写字母组成, 但必须至少包括2种字符.</p><p><code>/(?!^[0-9]{6,12}$)(?!^[a-z]{6,12}$)(?!^[A-Z]{6,12}$)^[0-9A-Za-z]{6,12}$/</code>.</p><p>这个正则其实可以使用多个小正则来做:</p><p><code>/^[0-9A-Za-z]{6,12}$/</code>.</p><p><code>/^[0-9]{6,12}$/</code>.</p><p><code>/^[A-Z]{6,12}$/</code>.</p><p><code>/^[a-z]{6,12}$/</code>.</p><h2 id="准确性" tabindex="-1"><a class="header-anchor" href="#准确性"><span>准确性</span></a></h2><p>所谓准确性, 就是能匹配预期的目标, 并且不匹配非预期的目标.</p><p>这里提到了<mark>预期</mark>二字, 那么我们就需要知道目标的组成规则.</p><p>不然没法界定什么样的目标字符串是符合预期的, 什么样的又不是符合预期的.</p><p>下面将举例说明, 当目标字符串构成比较复杂时, 该如何构建正则, 并考虑到哪些平衡.</p><h3 id="匹配固定电话" tabindex="-1"><a class="header-anchor" href="#匹配固定电话"><span>匹配固定电话</span></a></h3><p>比如要匹配如下格式的固定电话号码:</p><p><code>055188888888</code>.</p><p><code>0551-88888888</code>.</p><p><code>(0551)88888888</code>.</p><p>第一步, 了解各部分的模式规则.</p><p>上面的电话, 总体上分为区号和号码两部分(不考虑分机号和+86的情形).</p><p>区号是0开头的3到4位数字, 对应的正则是: <code>0\d{2,3}</code>.</p><p>号码是非0开头的7到8位数字, 对应的正则是: <code>[1-9]\d{6,7}</code>.</p><p>因此, 匹配<code>055188888888</code>的正则是: <code>/^0\d{2,3}[1-9]\d{6,7}$/</code>.</p><p>匹配<code>0551-88888888</code>的正则是: <code>/^0\d{2,3}-[1-9]\d{6,7}$/</code>.</p><p>匹配<code>(0551)88888888</code>的正则是: <code>/^\(0\d{2,3}\)[1-9]\d{6,7}$/</code>.</p><p>第二步, 明确形式关系.</p><p>这三者情形是或的关系, 可以构建分支:</p><p><code>/^0\d{2,3}[1-9]\d{6,7}$|^0\d{2,3}-[1-9]\d{6,7}$|^\(0\d{2,3}\)[1-9]\d{6,7}$/</code>.</p><p>提取公共部分:</p><p><code>/^(0\d{2,3}|0\d{2,3}-|\(0\d{2,3}\))[1-9]\d{6,7}$/</code>.</p><p>进一步简写:</p><p><code>/^(0\d{2,3}-?|\(0\d{2,3}\))[1-9]\d{6,7}$/</code>.</p><p>其可视化形式:</p><figure><img src="/assets/279caf5c12319439086d23dbe5948d47adef252e-DnmiSzuM.png" alt="279caf5c12319439086d23dbe5948d47adef252e" tabindex="0" loading="lazy"><figcaption>279caf5c12319439086d23dbe5948d47adef252e</figcaption></figure><p>上面的正则构建过程略显罗嗦, 但是这样做, 能保证正则是准确的.</p><p>上述三种情形是或的关系，这一点很重要，不然很容易按字符是否出现的情形把正则写成:</p><p><code>/^\(?0\d{2,3}\)?-?[1-9]\d{6,7}$/</code>.</p><p>虽然也能匹配上述目标字符串, 但也会匹配<code>(0551-88888888</code>这样的字符串. 当然, 这不是我们想要的.</p><p>其实这个正则也不是完美的, 因为现实中, 并不是每个3位数和4位数都是一个真实的区号.</p><p>这就是一个平衡取舍问题, 一般够用就行.</p><h2 id="效率" tabindex="-1"><a class="header-anchor" href="#效率"><span>效率</span></a></h2><p>保证了准确性后, 才需要是否要考虑要优化.大多数情形是不需要优化的, 除非运行的非常慢. 什么情形正则表达式运行才慢呢? 我们需要考察正则表达式的运行过程(原理).</p><p>正则表达式的运行分为如下的阶段:</p><ol><li>编译.</li><li>设定起始位置.</li><li>尝试匹配.</li><li>匹配失败的话, 从下一位开始继续第3步.</li><li>最终结果: 匹配成功或失败.</li></ol><p>匹配会出现效率问题, 主要出现在上面的第3阶段和第4阶段.</p><p>因此, 主要优化手法也是针对这两阶段的.</p><h3 id="使用具体型字符组代替通配符消除回溯" tabindex="-1"><a class="header-anchor" href="#使用具体型字符组代替通配符消除回溯"><span>使用具体型字符组代替通配符消除回溯</span></a></h3><p>而在第三阶段, 最大的问题就是回溯.</p><p>例如, 匹配双引用号之间的字符. 如, 匹配字符串123<code>abc</code>456中的<code>abc</code>.</p><p>如果正则用的是: <code>/&quot;.*&quot;/,</code>, 会在第3阶段产生4次回溯(粉色表示<code>.*</code>匹配的内容):</p><table><thead><tr><th style="text-align:center;">步骤</th><th style="text-align:center;">文本</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;"><img src="/assets/a5067377e2b907a5bbb80b33957fb8c135b73e24-lENsdR8P.png" alt="a5067377e2b907a5bbb80b33957fb8c135b73e24" loading="lazy"></td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;"><img src="/assets/41f451b58f75b4280337816e000ee1dec0eb2051-jTSnE6BV.png" alt="41f451b58f75b4280337816e000ee1dec0eb2051" loading="lazy"></td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;"><img src="/assets/ef6d26401fb989ea8ab06fa7ab96ac6b7b4d721c-C6m5DEmy.png" alt="ef6d26401fb989ea8ab06fa7ab96ac6b7b4d721c" loading="lazy"></td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;"><img src="/assets/23b1e7ae90158f65204003938e37939682f1305a-YJzF4Vf3.png" alt="23b1e7ae90158f65204003938e37939682f1305a" loading="lazy"></td></tr><tr><td style="text-align:center;">5</td><td style="text-align:center;"><img src="/assets/9bd0ea4b8f8da469c2131379d6437fac38ff6722-CDbrRukI.png" alt="9bd0ea4b8f8da469c2131379d6437fac38ff6722" loading="lazy"></td></tr><tr><td style="text-align:center;">6</td><td style="text-align:center;"><img src="/assets/c7f432db3324b46338af946af2a7d98f573b8aea-D65GXAoq.png" alt="c7f432db3324b46338af946af2a7d98f573b8aea" loading="lazy"></td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;"><img src="/assets/5b0b02b0326343840f22e3f91d4a99519995d352-BxGNdJJ6.png" alt="5b0b02b0326343840f22e3f91d4a99519995d352" loading="lazy"></td></tr><tr><td style="text-align:center;">8</td><td style="text-align:center;"><img src="/assets/76a70ef1d2875cabd5ffe4c451b225dd1752f63a-oUAsi1xm.png" alt="76a70ef1d2875cabd5ffe4c451b225dd1752f63a" loading="lazy"></td></tr><tr><td style="text-align:center;">9</td><td style="text-align:center;"><img src="/assets/600924080d818f601e3a877e819f5c6ee00b35be-pW4eKboe.png" alt="600924080d818f601e3a877e819f5c6ee00b35be" loading="lazy"></td></tr><tr><td style="text-align:center;">10</td><td style="text-align:center;"><img src="/assets/03084e7233ca1842fcc6dd110e2eb85d5fc7ad51-Dj7RyxDC.png" alt="03084e7233ca1842fcc6dd110e2eb85d5fc7ad51" loading="lazy"></td></tr><tr><td style="text-align:center;">11</td><td style="text-align:center;"><img src="/assets/d9070c5a763f18950db7756780381928c0df65be-DE7oEOEb.png" alt="d9070c5a763f18950db7756780381928c0df65be" loading="lazy"></td></tr><tr><td style="text-align:center;">12</td><td style="text-align:center;"><img src="/assets/cce26b8d9180837d9d61e7b0ab46303be3f09df2-DjFOPlrr.png" alt="cce26b8d9180837d9d61e7b0ab46303be3f09df2" loading="lazy"></td></tr><tr><td style="text-align:center;">13</td><td style="text-align:center;"><img src="/assets/94e61bc13723bd3fc792ef02b9135bceae94a3a9-D4U-FvAO.png" alt="94e61bc13723bd3fc792ef02b9135bceae94a3a9" loading="lazy"></td></tr></tbody></table><p>如果正则用的是:<code>/&quot;.*?&quot;/</code>, 会产生2次回溯(粉色表示<code>.*?</code>匹配的内容):</p><table><thead><tr><th style="text-align:center;">步骤</th><th style="text-align:center;">文本</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;"><img src="/assets/50edf82c42a5e1459c9f6037b53d9f3977a081d4-Bs0I9jAM.png" alt="50edf82c42a5e1459c9f6037b53d9f3977a081d4" loading="lazy"></td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;"><img src="/assets/3cf9ea3d6d3e624bf023b57b46227d4c36edf920-D8D1-72Q.png" alt="3cf9ea3d6d3e624bf023b57b46227d4c36edf920" loading="lazy"></td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;"><img src="/assets/accfc60076b0044f48191966130fa9b13f7f9db7-tUWZ1i5g.png" alt="accfc60076b0044f48191966130fa9b13f7f9db7" loading="lazy"></td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;"><img src="/assets/9d11a76d086eeb8e9351e4ad19d77a33ba5b667a-Cmh_h61X.png" alt="9d11a76d086eeb8e9351e4ad19d77a33ba5b667a" loading="lazy"></td></tr><tr><td style="text-align:center;">5</td><td style="text-align:center;"><img src="/assets/b1afd07a0266dff10447cbb7915f08f9adb39c9b-CQqMfZYX.png" alt="b1afd07a0266dff10447cbb7915f08f9adb39c9b" loading="lazy"></td></tr></tbody></table><p>因为回溯的存在, 需要引擎保存多种可能中未尝试过的状态, 以便后续回溯时使用.注定要占用一定的内存.</p><p>此时要使用具体化的字符组. 来代替通配符<code>.</code>. 以便消除不必要的字符. 此时使用正则<code>/&quot;[^&quot;]*&quot;/</code>. 即可.</p><h3 id="使用非捕获型分组" tabindex="-1"><a class="header-anchor" href="#使用非捕获型分组"><span>使用非捕获型分组</span></a></h3><p>因为括号的作用之一是, 可以捕获分组和分支里的数据. 那么就需要内存来保存它们.</p><p>当我们不需要使用分组引用和反向引用时, 此时可以使用非捕获分组. 例如:</p><p><code>/^[+-]?(\d+\.\d+|\d+|\.\d+)$/</code>.</p><p>可以修改成:</p><p><code>/^[+-]?(?:\d+\.\d+|\d+|\.\d+)$/</code>.</p><h3 id="独立出确定字符" tabindex="-1"><a class="header-anchor" href="#独立出确定字符"><span>独立出确定字符</span></a></h3><p>例如<code>/a+/</code>, 可以修改成<code>/aa*/</code>.</p><p>因为后者能比前者多确定了字符a. 这样会在第四步中, 加快判断是否匹配失败, 进而加快移位的速度.</p><h3 id="提取分支公共部分" tabindex="-1"><a class="header-anchor" href="#提取分支公共部分"><span>提取分支公共部分</span></a></h3><p>比如/<code>^abc|^def/</code>, 修改成<code>/^(?:abc|def)/</code>.</p><p>又比如<code>/this|that/</code>, 修改成<code>/th(?:is|at)/</code>.</p><p>这样做, 可以减少匹配过程中可消除的重复.</p><h3 id="减少分支数量缩小范围" tabindex="-1"><a class="header-anchor" href="#减少分支数量缩小范围"><span>减少分支数量缩小范围</span></a></h3><p><code>/red|read/</code>, 可以修改成<code>/rea?d/</code>. 此时分支和量词产生的回溯的成本是不一样的. 但这样优化后, 可读性会降低的.</p></div><!----><!----><div class="vp-doc-copyright" data-v-3d04b82b><h2 id="doc-copyright" tabindex="-1" class="vp-doc-header" data-v-1f9e73ce><a href="#doc-copyright" class="header-anchor" data-v-1f9e73ce><span data-v-1f9e73ce><!--[-->版权所有<!--]--></span></a></h2><div class="vp-copyright" data-v-0556df07><span class="copyright-mask" data-v-0556df07></span><p data-v-0556df07><span data-v-0556df07>版权归属：</span><a class="vp-link link no-icon vp-external-link-icon" href="https://github.com/Erhai-lake" target="_blank" rel="noreferrer" data-v-0556df07><!--[-->Erhai-lake<!--]--></a></p><!----><p data-v-0556df07><span data-v-0556df07>许可证：</span><a class="vp-link link no-icon vp-external-link-icon" href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noreferrer" data-v-0556df07><!--[-->署名 4.0 国际 (CC-BY-4.0)<!--]--></a><!--[--><span class="vpi-license-cc" data-v-0556df07></span><span class="vpi-license-by" data-v-0556df07></span><!--]--></p></div></div><footer class="vp-doc-footer" data-v-3d04b82b data-v-650a9339><!--[--><!--]--><div class="edit-info" data-v-650a9339><div class="edit-link" data-v-650a9339><a class="vp-link link no-icon vp-external-link-icon edit-link-button" href="https://github.com/Erhai-lake/ElakeDocs/edit/master/docs/knowledge/tools/regular_expression/build.md" target="_blank" rel="noreferrer" data-v-650a9339><!--[--><span class="vpi-square-pen edit-link-icon" aria-label="edit icon" data-v-650a9339></span> 编辑此页<!--]--></a></div><!----></div><div class="contributors" aria-label="Contributors" data-v-650a9339><span class="contributors-label" data-v-650a9339>贡献者: </span><span class="contributors-info" data-v-650a9339><!--[--><!--[--><span class="contributor" data-v-650a9339>Erhai-lake</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-650a9339><div class="pager" data-v-650a9339><a class="vp-link link pager-link prev" href="/knowledge/tools/regular_expression/split.html" data-v-650a9339><!--[--><span class="desc" data-v-650a9339>上一页</span><span class="title" data-v-650a9339><!----><span data-v-650a9339>拆分</span></span><!--]--></a></div><div class="pager" data-v-650a9339><a class="vp-link link pager-link next" href="/knowledge/tools/regular_expression/modifier.html" data-v-650a9339><!--[--><span class="desc" data-v-650a9339>下一页</span><span class="title" data-v-650a9339><!----><span data-v-650a9339>修饰符</span></span><!--]--></a></div></nav></footer></div><!--]--></main><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;" data-v-3d04b82b><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button type="button" class="vp-back-to-top" aria-label="back to top" data-v-e0480511 style="display:none;" data-v-dba59023><span class="percent" data-allow-mismatch data-v-dba59023>0%</span><span class="show icon vpi-back-to-top" data-v-dba59023></span><svg aria-hidden="true" data-v-dba59023><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-dba59023></circle></svg></button><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="sign down" class="vp-sign-down" aria-hidden="true" data-v-e0480511 style="display:none;" data-v-faa782fa><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" data-v-faa782fa><path d="m19 11l-7 6l-7-6" data-v-faa782fa></path><path d="m19 5l-7 6l-7-6" opacity="0.6" data-v-faa782fa></path></g></svg><footer class="vp-footer has-sidebar" vp-footer data-v-e0480511 data-v-10717479><!--[--><div class="container" data-v-10717479><div class="message" data-v-10717479>Power by <a target='_blank' href='https://v2.vuepress.vuejs.org/'>VuePress</a> & <a target='_blank' href='https://theme-plume.vuejs.press'>vuepress-theme-plume</a></div><div class="copyright" data-v-10717479>Copyright © 2024-present Erhai_lake</div></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-znotv2QM.js" defer></script></body></html>