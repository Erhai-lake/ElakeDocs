---
title: 模板字符串
createTime: 2026/02/06 18:17:19
---

**模板** 是 **Mock Service** 的灵魂. 整个库的架构设计, 本质上都是为了支撑模板的高效生成与精准解析.

## 什么是模板字符串?

模板字符串是一种声明式的语法, 允许你通过简单的文本描述来构建复杂的数据生成逻辑.

### 语法结构解析

一个典型的模板定义如下:

`{{$category.generator(params)|processor(params)}}`

* **双大括号 `{{ }}`**: 模板的边界标识符, 内部所有的逻辑都在这对括号中完成.
* **方法标识 `$`**: 紧跟在 `{{` 之后, 代表这是一个**动态调用**. 它告诉解析器去寻找注册过的生成器.
* **资源定位**: 使用 `分类ID.生成器ID` 的形式定位具体的生成逻辑. 例如 `$person.name`.
* **管道符 `|`**: 代表**处理链**. 生成器产出的初始值会沿着管道依次传递给后续的处理器进行二次加工.
* **参数传递 `()`**:
	* **多参数**: 使用 `{key=value}` 形式. 例如 `({length=10,type="hex"})`.
	* **单参数**: 如果方法只需一个参数, 可直接简写. 例如 `(114514)`.
	* **赋值符**: 参数内部统一使用 `=` 进行赋值, 多个参数间用 `,` 分隔.

## 进阶特性

### 递归嵌套

模板支持**深度嵌套**. 你可以在一个模板的参数位置, 嵌入另一个完整的模板. 解析器会从最内层开始递归执行, 实现极具灵活性的组合.

> **示例概念**: `{{$string.uuid|concat("{{$string.uuid}})")}}`
>
> 先生成一个uuid, 随后在生成一个uuid, 最后将这两个字符串拼接起来.

### 变量支持 (即将到来)

在未来的版本中, 模板将引入一个**变量系统**.

* **直接访问**: 使用 `{{variableName}}` 即可引用上下文中的变量, 无需 `$` 符号.
* **默认值**: 支持 `{{variableName="defaultValue"}}` 语法. 当变量不存在或为空时, 将自动降级使用默认值.

可以通过特定方法设置变量, 或者使用生成器写入/读取变量. 然后在后文调用. 例如:

`生成UUID{{$variable.add({name="uuid",value="{{$string.uuid}}})}}完成. 你的UUID是: {{uuid}}`

::: note
以上是对变量系统的设想, 目前还未实现.
:::

## 快速查阅表

| 符号        | 含义      | 示例                 |
|:----------|:--------|:-------------------|
| `{{...}}` | 模板容器    | `{{$string.uuid}}` |
| `$`       | 调用生成器方法 | `$date.now`        |
| `.`       | 路径分隔符   | `category.id`      |
| `\|`      | 处理链     | `...\|upper\|trim` |
| `(...)`   | 参数区域    | `(limit=10)`       |
| `=`       | 参数赋值    | `key=value`        |

倒也没必要记, 有模板生成方法 [`generateTemplate`](./generate_template) 的.